<%= render "componants/searchbar" %>
<!-- app/views/users/profile.html.erb -->
<div class="profile-container">
  <div class="profile-banner">
    <div class="banner-overlay"></div>
    <img src="https://images5.alphacoders.com/135/1350853.png" alt="" class="banner-image">
  </div>
  <div class="profile-header">
    <div class="profile-avatar">
      <img src="https://fbi.cults3d.com/uploaders/22931489/illustration-file/3e0ab758-1c4c-489a-be62-5ba444c202e0/vault_boy.0.jpg" alt="" class="avatar-image">
      <div class="avatar-upload">
        <%= form_for @user, html: { multipart: true } do |f| %>
          <%= f.file_field :avatar, class: "avatar-input" %>
          <label class="avatar-label">
            <i class="fas fa-camera"></i>
          </label>
        <% end %>
      </div>
    </div>
    <div class="profile-info">
      <h1 class="profile-name">
        <%= @user.username %>
        <% if @user.role %>
          <span class="pro-badge">PRO <i class='bx bxs-badge-check'></i></span>
        <% end %>
      </h1>
      <div class="user-details">
        <p><i class="fas fa-envelope"></i> <%= @user.email %></p>
        <p><i class="fas fa-map-marker-alt"></i> France</p>
        <p class="bio">Aucune biographie renseignée</p>
      </div>
    </div>
    <div class="profile-actions">
      <%= link_to edit_user_registration_path, class: "edit-profile-btn" do %>
        <i class="fas fa-edit"></i> Modifier le profil
      <% end %>
    </div>
  </div>
  <div class="profile-content">
    <div data-controller="tabs">
      <%# Tabs Navigation %>
      <div class="profile-tabs">
        <button class="tab-btn active"
            data-tabs-target="tab"
            data-action="click->tabs#switch">
          Rendez-vous
        </button>
        <% if @user.role %>
          <button class="tab-btn"
              data-tabs-target="tab"
              data-action="click->tabs#switch">
            Services
          </button>
        <% end %>
        <button class="tab-btn"
            data-tabs-target="tab"
            data-action="click->tabs#switch">
          Avis
        </button>
      </div>
      <%# Tabs Content %>
      <div class="tab-content">
        <%# Appointments Tab %>
        <div id="appointments" class="tab-pane" data-tabs-target="pane">
          <h3>Mes Rendez-vous</h3>
          <% @appointments&.each do |appointment| %>
            <div class="appointment-card">
              <h4><%= appointment.daddy_service.title %></h4>
              <p>Date: <%= appointment.date.strftime("%d/%m/%Y") %></p>
              <p>Status: <%= appointment.status %></p>
            </div>
          <% end %>
        </div>
        <%# Services Tab %>
        <% if @user.role %>
          <div id="services" class="tab-pane" data-tabs-target="pane">
            <h3>Mes Services</h3>
            <% DaddyService.where(user_id: current_user.id).each do |service| %>
              <div class="service-card">
                <h4><%= service.title %></h4>
                <p><%= service.description %></p>
                <p>Prix: <%= number_to_currency(service.price) %></p>
                <p>Catégorie: <%= service.category.name %></p>
                <div class="service-actions">
                  <%= link_to "Modifier", edit_daddy_service_path(service), class: "edit-btn" %>
                  <%= link_to "Supprimer", daddy_service_path(service),
                  method: :delete,
                  data: { confirm: "Êtes-vous sûr ?" },
                  class: "delete-btn" %>
                </div>
              </div>
            <% end %>
          </div>
        <% end %>
        <%# Reviews Tab %>
        <div id="reviews" class="tab-pane" data-tabs-target="pane">
          <h3>Avis</h3>
          <!-- Add reviews content here -->
        </div>
      </div>
    </div>
  </div>
